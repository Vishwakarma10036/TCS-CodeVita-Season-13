Minimum Distance
Problem Description
You are in a world of stars, where all your movements depend on them - you can only travel from one star to another.

Each star is formed from lines that are either horizontal, vertical, or strictly diagonal. The point where two or more-line segments intersects is call the centre of the star. You are given the position of the stars, a starting point, and a destination point. Your task is to determine the minimum number of stars you must use to reach the destination, following the movement rules below. If the destination is unreachable, then find the minimum distance it must be shifted to make to reachable by using stars. The distance is measured using Chebyshev distance.

You are allowed to rotate stars any number of times to create temporary paths for your movement from the source to the destination.

Star Rotation Rules:

Think of directions as:
North (N), South (S), East (E), West (W), Northeast (NE), Northwest (NW), Southeast (SE), Southwest (SW).

Consider the below figure as a star.

com.tcs.cv.automata.ei.middleware.DocxToHtmlConverter@68ace111:image1.png

When a star is rotated clockwise, each of its extending arms from the centre, shifts as follows.

The line pointing North rotates to point East
East becomes South
South becomes West
West becomes North
For diagonal directions:

Northwest (NW) rotates to Northeast (NE)
Northeast (NE) becomes Southeast (SE)
Southeast (SE) becomes Southwest (SW)
Southwest (SW) becomes Northwest (NW)
And vice versa for the anticlockwise direction.

Constraints
1 < Number of stars in the input < 20

1 < N < 100

Stars are confined to a maximum size of 100Ã—100 grid.

A solitary star, after rotation, may connect to or touch multiple other stars.

While intersections are allowed, no two lines will partially overlap.

There will always be a path to the destination, either with or without shifting the destination.

Input
First line consists of an integer denoting the number of lines segments which forms the stars.

Next N lines consist of 4 space separated integers x1 y1 x2 y2 denoting the starting and ending coordinates of the line segments.

Second line from the last consist of two space separated integers denoting the x and y coordinates of the source.

Last line consists of two space separated integers denoting the x and y coordinates of the destination.

Output
Print a single integer representing the minimum number of stars required to travel from the source to the destination. If reaching the destination is not possible, print the minimum distance the destination must be shifted to make it reachable by stars.

Note that the starting and ending stars are also counted.

Time Limit (secs)
1

Examples
Example 1

Input

8

1 1 3 3

2 1 2 4

1 3 3 1

4 2 10 8

5 5 7 3

1 5 1 8

1 8 2 7

1 8 2 9

2 3

2 9

Output

3

Explanation

The lines provided in the input represent stars as illustrated below.

com.tcs.cv.automata.ei.middleware.DocxToHtmlConverter@68ace111:image2.gif

As illustrated in the animation above, there are three stars in total. The starting point is at (2, 3), and the goal is to reach the destination at (2, 9).

To achieve this, first rotate the star centered at (6, 4) to form a connection with the star centered at (2, 2), and move to that star. Next, again rotate the star at (6, 4) to establish a connection with the star at (1, 8), and shift to it. Finally, by rotating the star at (1, 8), you can reach the destination.

Since a total of three stars are involved in this process, the output is 3.

Example 2

Input

6

2 2 3 3

8 3 8 7

4 2 3 3

8 4 7 5

3 4 3 3

8 4 9 5

8 6

8 1

Output

1

Explanation

com.tcs.cv.automata.ei.middleware.DocxToHtmlConverter@68ace111:image3.gif

As shown in the above animation, there are two stars centered at (3, 3) and (8, 4). We can see that rotating the star at (8, 4) twice can help in reaching the destination (8, 1). Hence only one star is used.

Example 3

Input

6

2 2 3 3

8 3 8 7

4 2 3 3

8 4 7 5

3 4 3 3

8 4 9 5

8 6

5 5

Output

1

Explanation

com.tcs.cv.automata.ei.middleware.DocxToHtmlConverter@68ace111:image4.gif

This example is same as above, but the destination point is different. As we can see no matter what stars you rotate, you can not reach the destination. Therefore, we must find the minimum distance we need to shift the destination point to make it reachable which is 1. Hence, print the same.